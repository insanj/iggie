<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="iggie: interactive github site history">
    <meta name="author" content="insanj">
    <link rel="icon" type="image/png" href="resources/robot.png">

    <title>iggie</title>

    <!-- Bootstrap core CSS -->
    <link href="resources/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="resources/cover.css" rel="stylesheet">
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  </head>
  <body class="text-center" style="z-index: 10;">
    <div class="cover-container d-flex h-100 p-3 mx-auto flex-column" style="z-index: 6;">
      <header class="masthead mb-auto" style="z-index: 7;">
        <div class="inner">
          <a href="http://iggie.site"><h3 class="masthead-brand text-white">ðŸ¤– iggie</h3></a>
          <nav class="nav nav-masthead justify-content-center">
            <a class="nav-link active" href="/run">âš¡ Run</a>
            <a class="nav-link" href="https://github.com/insanj/iggie" target=_blank>ðŸ’š Github</a>
          </nav>
        </div>
      </header>

      <main role="main" class="inner cover text-white" style="z-index: 5;">
        <h1 class="display-3 m-3">ðŸ‘‹ hi, i'm <a href="#" data-toggle="tooltip" data-container="body" data-original-title="ðŸ¤– interactive github site history">iggie</a></h1>

        <h2 class="font-weight-light">ðŸ’­ have you ever built a site on Github?</h2>
        <h4 class="font-weight-light mt-5">
        ðŸŽ‰ today's your lucky day! iggie makes exploring the history of any site easy &amp; fast
        </h4>
        <p class="lead mt-5">
          <div class="input-group m-3 mx-auto" id="github">
            <div class="input-group-prepend">
              <span class="input-group-text" style="text-shadow: none;" id="inputGroup-sizing-lg"><img src="resources/github.svg" width=20 height=20 class="mr-2">Github</span>
            </div>
              <input type="text" id="username" class="form-control needs-validation" value="insanj" placeholder="username" />
              <span class="input-group-text rounded-0" style="text-shadow: none;">/</span>
              <input type="text" id="repository" class="form-control needs-validation" value="insanj.com" placeholder="repository" />
          </div>

          <a href="#" id="run" class="btn btn-lg btn-secondary">âš¡ Run</a>
        </p>
      </main>

      <footer class="mastfoot mt-auto" style="z-index:8;">
        <div class="inner">
            <p>(c) 2018 <a href="https://insanj.com">Julian Weiss</a> aka <a href="https://twitter.com/insanj">@insanj</a></p>
        </div>
      </footer>
    </div>

    <canvas>
    </canvas>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="resources/jquery-3.js"></script>
    <script src="resources/popper.js"></script>
    <script src="resources/bootstrap.js"></script>

    <script>
$(function () {
  $('[data-toggle="tooltip"]').tooltip()
});
    </script>

    <!-- wave -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.0/TweenLite.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.0/easing/EasePack.min.js"></script>

    <script type="text/javascript" src="resources/wave/js/libs/signals.min.js"></script>
    <script type="text/javascript" src="resources/wave/js/libs/CMControl.min.js"></script>
    <script type="text/javascript" src="resources/wave/js/Wave.js"></script>

    <script>
function scrubAwayWaveUI() {
  window.setTimeout(function () {
    $(".sidebar").remove();
    $("canvas").css({"position" : "fixed", "top" : 0, "left" : 0, "right" : 0, "bottom" : 0, "z-index" : 0 });
  }, 100);
}

function generateRandomNumber(min, max, nearMean) {
  var rand = function(randMin, randMax) {
    return Math.floor(Math.random() * randMax) + randMin;
  }

  if (nearMean == true) {
    var diff = Math.abs(max - min) / 2;
    var meanMax = max - (diff / 2);
    var meanMin = min + (diff / 2);
    return rand(meanMin, meanMax);
  } else {
    return rand(min, max);
  }
}

function simulateTouch(cooldown) {
  $canvas = document.getElementsByTagName('canvas')[0];
  var e = document.createEvent('UIEvent');
// var e = $.Event("mousedown", { pageX: randX, pageY:randY } );

  var randX = generateRandomNumber(1, $canvas.width, false);
  var randY = $canvas.height / 2.0; //generateRandomNumber(1, $canvas.height, true);

  var downEventName = 'mousedown';
  var upEventName = 'mouseup';
  if (!!('ontouchstart' in window)) {
    downEventName = 'touchstart';
    upEventName = 'touchend';
  }

  e.initUIEvent(downEventName, true, true);
  e.pageX = randX;
  e.pageY = randY;
  e.touches = [{pageX: randX, pageY: randY}];
  $canvas.dispatchEvent(e);

  setTimeout(function () {
    e.initUIEvent(upEventName, true, true);
    $canvas.dispatchEvent(e);
    
    setTimeout(function() {
      simulateTouch(cooldown);
    }, cooldown)

  }, 100);
}

function showAlert(message) {
  $("#alert-main").remove();

  var alertDiv = '<div id="alert-main" class="alert alert-warning">';
  alertDiv = alertDiv + message;
  alertDiv = alertDiv + '</div>';

  $("main").append(alertDiv);
}

function run() {
  var username = $("#username").val();
  var repository = $("#repository").val();

  if (username == null || username.length <= 0) {
    showAlert("âš  Sorry, you forgot to put in a Github username!");
  } else if (repository == null || repository.length <= 0) {
    showAlert("âš  Sorry, you forgot to put in a Github repository!");
  } else {
    var filename = "index.html";
    var composedURL = "run/index.html?username=" + username + "&repository=" + repository + "&filename=" + filename;
    window.location.href = composedURL;
  }
}

window.onload = Wave.init
$(function () {
  scrubAwayWaveUI();
  simulateTouch(2000);

  $('main').popover({
    container: 'main',
    content: function() {
      return 'Put in a username & repository to let ðŸ¤– iggie pull the site in for you! ðŸŒ¹';
    },
    placement : function() {
      return "bottom";
    },
    trigger: 'hover'
  });
});

$("#run").on("click", function() {
  run();
});

$(document).keydown(function(e) {
  if (e.which == 13) { // right
    e.preventDefault();
    run();
  }
});
    </script>
</body></html>